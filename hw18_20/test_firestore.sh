#!/bin/bash

echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firestore..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Firestore —ç–º—É–ª—è—Ç–æ—Ä–∞
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ Firestore —ç–º—É–ª—è—Ç–æ—Ä–∞ (localhost:8080)..."
if nc -z localhost 8080 2>/dev/null; then
    echo "‚úÖ Firestore —ç–º—É–ª—è—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω"

    # –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ curl (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
    if command -v curl &> /dev/null; then
        echo "üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è..."
        response=$(curl -s -o /dev/null -w "%{http_code}" http://localhost:8080)
        if [ "$response" = "200" ] || [ "$response" = "404" ]; then
            echo "‚úÖ HTTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∫–æ–¥: $response)"
        else
            echo "‚ö†Ô∏è HTTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–µ—Ä–Ω—É–ª–æ –∫–æ–¥: $response"
        fi
    fi
else
    echo "‚ùå Firestore —ç–º—É–ª—è—Ç–æ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω"
    echo "üí° –ó–∞–ø—É—Å—Ç–∏—Ç–µ: ./start_emulators.sh"
fi

echo ""
echo "üì± –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:"
echo "1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç–º—É–ª—è—Ç–æ—Ä—ã: ./start_emulators.sh"
echo "2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: flutter run"
echo "3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —ç–º—É–ª—è—Ç–æ—Ä–∞–º"
echo "4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É"