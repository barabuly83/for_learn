# Firebase Setup (Storage + Firestore)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π Firebase Storage

–≠—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Java –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞.

#### 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Firebase Console:

**–î–ª—è Storage:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ [Firebase Console](https://console.firebase.google.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç **hw13-15**
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage** ‚Üí **Rules**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:
```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      allow read, write: if request.auth != null;
    }
  }
}
```
5. –ù–∞–∂–º–∏—Ç–µ **Publish**

**–î–ª—è Firestore:**
1. –í Firebase Console –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Firestore Database**
2. –í—ã–±–µ—Ä–∏—Ç–µ **Create database** (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞)
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º **Start in test mode** –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Rules** –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ (–ø—Ä–∏–º–µ—Ä –≤ `firestore.rules`)

#### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
flutter run
```

**–í–∞–∂–Ω–æ:** –ó–∞–ø—É—Å–∫–∞–π—Ç–µ **–ë–ï–ó** —Ñ–ª–∞–≥–∞ `USE_STORAGE_EMULATOR`, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π Firebase Storage.

---

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º—É–ª—è—Ç–æ—Ä Firebase Storage

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è Java (JDK 11 –∏–ª–∏ –≤—ã—à–µ)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Java (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):

**macOS (—á–µ—Ä–µ–∑ Homebrew):**
```bash
brew install openjdk@11
```

**–ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞:**
https://www.oracle.com/java/technologies/downloads/

### –ó–∞–ø—É—Å–∫ —ç–º—É–ª—è—Ç–æ—Ä–∞:

#### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç–º—É–ª—è—Ç–æ—Ä—ã (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):
```bash
# –¢–æ–ª—å–∫–æ Storage
firebase emulators:start --only storage --project hw13-15

# –¢–æ–ª—å–∫–æ Firestore
firebase emulators:start --only firestore --project hw13-15

# Storage + Firestore –≤–º–µ—Å—Ç–µ
firebase emulators:start --only storage,firestore --project hw13-15
```

–î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è:
```
‚úî  All emulators ready! It is now safe to connect.
```

#### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ñ–ª–∞–≥–æ–º —ç–º—É–ª—è—Ç–æ—Ä–∞:
```bash
# –° Storage —ç–º—É–ª—è—Ç–æ—Ä–æ–º
flutter run --dart-define=USE_STORAGE_EMULATOR=true

# –° Firestore —ç–º—É–ª—è—Ç–æ—Ä–æ–º
flutter run --dart-define=USE_FIRESTORE_EMULATOR=true

# –° –æ–±–æ–∏–º–∏ —ç–º—É–ª—è—Ç–æ—Ä–∞–º–∏
flutter run --dart-define=USE_STORAGE_EMULATOR=true --dart-define=USE_FIRESTORE_EMULATOR=true
```

#### 3. –û—Ç–∫—Ä–æ–π—Ç–µ UI —ç–º—É–ª—è—Ç–æ—Ä–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
http://127.0.0.1:4000

---

## ‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: `Failed to connect to /10.0.2.2:9199`
**–ü—Ä–∏—á–∏–Ω–∞:** –≠–º—É–ª—è—Ç–æ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —ç–º—É–ª—è—Ç–æ—Ä—É, –Ω–æ –æ–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–ë–ï–ó** —Ñ–ª–∞–≥–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞:
```bash
flutter run
```

### –û—à–∏–±–∫–∞: `Java is not installed`
**–ü—Ä–∏—á–∏–Ω–∞:** Java –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–µ.

**–†–µ—à–µ–Ω–∏–µ:** 
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Java (—Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ)
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π Firebase Storage (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –û—à–∏–±–∫–∞: `permission-denied` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firebase Storage –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ Firebase Console (—Å–º. —Ä–∞–∑–¥–µ–ª "–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç" –≤—ã—à–µ)

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
source ~/.zshrc

---

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª—ã:
- `firebase.json` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–º—É–ª—è—Ç–æ—Ä–æ–≤ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —ç–º—É–ª—è—Ç–æ—Ä)
- `firestore.rules` - –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firestore (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
- `storage.rules` - –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Storage (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)

### –ê–¥—Ä–µ—Å–∞ —ç–º—É–ª—è—Ç–æ—Ä–æ–≤ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ):
- **Storage —ç–º—É–ª—è—Ç–æ—Ä**: `127.0.0.1:9199` (–¥–ª—è —Ö–æ—Å—Ç–∞) –∏–ª–∏ `10.0.2.2:9199` (–∏–∑ Android —ç–º—É–ª—è—Ç–æ—Ä–∞)
- **Firestore —ç–º—É–ª—è—Ç–æ—Ä**: `127.0.0.1:8080` (–¥–ª—è —Ö–æ—Å—Ç–∞) –∏–ª–∏ `10.0.2.2:8080` (–∏–∑ Android —ç–º—É–ª—è—Ç–æ—Ä–∞)
- **UI —ç–º—É–ª—è—Ç–æ—Ä–∞**: http://127.0.0.1:4000
